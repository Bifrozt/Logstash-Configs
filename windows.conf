input {
  tcp {
    port => 5000
    type => "windows"
    codec => json_lines { charset => CP1252 }
  }
}

filter {
  if [type] == "windows" {
    json {
      source => "message"
    }
    date {
      match => ["EventTime", "YYYY-MM-dd HH:mm:ss"]
    }
    if [SourceModuleName] == "eventlog" {
      mutate {
        remove_field => [ "message" ]
      }
    }
	  mutate {
		rename => [ "UserName", "Username" ]
		rename => [ "userName", "Username" ]
		rename => [ "User", "Username" ]
		rename => [ "user", "Username" ]
		rename => [ "UserID", "Username" ]
	  }
  }
}


output {
  if [type] == "windows" {
#    if [host] == "10.0.36.104" {
#      stdout { codec => rubydebug }
#    }
    elasticsearch {
      cluster => "heartland"
      protocol => http
    }
  }
}

